<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <property name="LOGS_DIR" value="${logback.dir}" />
    <property name="LOG_INFO_FILE" value="ipms-info.log" />
    <property name="LOG_WARN_FILE" value="ipms-warn.log" />
    <property name="LOG_ERROR_FILE" value="ipms-err.log" />
    <property name="infoFilePattern" value="[%p] %d{yyyy-MM-dd HH:mm:ss} -> %m%n" />
    <property name="filePattern" value="[%p] %d{yyyy-MM-dd HH:mm:ss}[%c][%M][%L]-> %m%n" />
    <property name="consolePattern" value="[%p] %d{yyyy-MM-dd HH:mm:ss}[%c][%M][%L]-> %m%n" />
    
    <appender name="LOG_INFO_ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOGS_DIR}/${LOG_INFO_FILE}</file>
        <!-- 日志过滤器，只记录info级别日志 ,若要配置其他级别，复制appender，修改level，并在root中配置-->
        <filter class="ch.qos.logback.classic.filter.LevelFilter"> 
            <level>INFO</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOGS_DIR}/%d{yyyy-MM-dd}/${LOG_INFO_FILE}.%d{yyyy-MM-dd}_%i.zip</fileNamePattern>
            <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                <maxFileSize>50MB</maxFileSize>
            </timeBasedFileNamingAndTriggeringPolicy>
        </rollingPolicy>        
        <encoder>
            <pattern>${infoFilePattern}</pattern>
        </encoder>
    </appender>
    
    <appender name="LOG_WARN_ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOGS_DIR}/${LOG_WARN_FILE}</file>
        <!-- 日志过滤器，只记录warn级别日志 ,若要配置其他级别，复制appender，修改level，并在root中配置-->
        <filter class="ch.qos.logback.classic.filter.LevelFilter"> 
            <level>WARN</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOGS_DIR}/%d{yyyy-MM-dd}/${LOG_WARN_FILE}.%d{yyyy-MM-dd}_%i.zip</fileNamePattern>
            <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                <maxFileSize>50MB</maxFileSize>
            </timeBasedFileNamingAndTriggeringPolicy>
        </rollingPolicy>    
        <encoder>
            <pattern>${filePattern}</pattern>
        </encoder>
    </appender>
    
    <appender name="LOG_ERROR_ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOGS_DIR}/${LOG_ERROR_FILE}</file>
        <!-- 日志过滤器，只记录warn级别日志 ,若要配置其他级别，复制appender，修改level，并在root中配置-->
        <filter class="ch.qos.logback.classic.filter.LevelFilter"> 
            <level>ERROR</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOGS_DIR}/%d{yyyy-MM-dd}/${LOG_ERROR_FILE}.%d{yyyy-MM-dd}_%i.zip</fileNamePattern>
            <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                <maxFileSize>50MB</maxFileSize>
            </timeBasedFileNamingAndTriggeringPolicy>
        </rollingPolicy> 
        <encoder>
            <pattern>${filePattern}</pattern>
        </encoder>
    </appender>
    
    <!-- 控制台输出 -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>${consolePattern}</pattern>
        </encoder>
    </appender>
    
    <logger name="java.sql.PreparedStatement" level="INFO" />
    <logger name="java.sql.Connection" level="INFO" />
    <logger name="java.sql.Statement" level="INFO" />
    <logger name="com.ibatis" level="INFO" />
    <logger name="com.ibatis.common.jdbc.SimpleDataSource" level="INFO" />
    <logger name="com.ibatis.common.jdbc.ScriptRunner" level="INFO" />
    <logger name="com.ibatis.sqlmap.engine.impl.SqlMapClientDelegate" level="INFO" />
    <logger name="org.springframework" level="WARN" />
    <logger name="net.sf.ehcache" level="ERROR"/>
    
    <root level="INFO">
        <appender-ref ref="STDOUT" /> <!-- 控制台输出 -->
        <appender-ref ref="LOG_INFO_ROLLING" /> <!-- 文件输出 -->
        <appender-ref ref="LOG_WARN_ROLLING" /> <!-- 文件输出 -->
        <appender-ref ref="LOG_ERROR_ROLLING" /> <!-- 文件输出 -->
    </root>
</configuration>